# ุชูุฑูุฑ ุงูุชุญููู ุงูููููู ุงูููู (WBGL v3.0)

## ๐ ููู ูุนูู WBGL ูุนูููุง

1. **ุงููุฏุฎูุงุช**: ูุชู ุงุณุชูุงู ูููุงุช Excel ูู `api/import.php` ูุญูุธ ุงูุจูุงูุงุช ุงูุฎุงู ูู ุฌุฏูู `guarantees` ุฏุงุฎู ุญูู `raw_data` (ุจุชูุณูู JSON).
2. **ุงููุนุงูุฌุฉ**: ุชุณุชุฏุนู `SmartProcessingService` ูุธุงู `AuthorityFactory` ูุชูููุฐ ุงููุทุงุจูุฉ. ุงููุทุงุจูุฉ ุชุนุชูุฏ ุนูู `normalized_name` ูู ุฌุฏุงูู ุงูููุฑุฏูู ูุงูุจููู.
3. **ุงูุงุณุชูุฑุงุฑ**: ูุชู ุชุณุฌูู ุงููุฑุงุฑุงุช ูู ุฌุฏูู `guarantee_decisions` ุงูุฐู ูุฑุจุท `guarantee_id` ุจู `supplier_id` ู `bank_id`.
4. **ุงููุฎุฑุฌุงุช**: ูููู `LetterBuilder` ุจุณุญุจ ุงูุจูุงูุงุช ูู `guarantee_decisions` ูุงูุฌุฏูู ุงูุฃุตูู ูุชูููุฏ HTML ููุงุฆู.

---

## ๐ ููุงุท ุงูุถุนู ุงูููุทููุฉ ุงูููุชุดูุฉ

1. **ุงูุงุนุชูุงุฏ ุนูู Schema-less JSON**: ุงููุตูู ููุจูุงูุงุช ูู `index.php` (ุงูุฃุณุทุฑ 214-228) ูุนุชูุฏ ูุจุงุดุฑุฉ ุนูู ููุงุชูุญ JSON ูุซู `['supplier']` ู `['amount']`. ุฃู ุชุบููุฑ ูู ุฑุคูุณ ุฃุนูุฏุฉ ููู ุงูุฅูุณู ุณูุคุฏู ููุดู ุงุณุชุฑุฌุงุน ุงูุญููู ุงูุฃุณุงุณูุฉ ุฏูู ุฅุทูุงู ุงุณุชุซูุงุก ูุงุถุญ.
2. **ุชุฏุงุฎู ุงูุฃุณูุงุก ุงููุทูุฑุฉ (Normalization Collisions)**: ูุนุชูุฏ `SupplierRepository` (ุงูุณุทุฑ 19) ุนูู `normalized_name`. ููุฏ `ArabicNormalizer` ูุฒูู ุงููุณุงูุงุช ูุงูุฑููุฒุ ููุง ูุคุฏู ูุฏูุฌ ููุงูุงุช ูุงููููุฉ ูุฎุชููุฉ ุชุญูู ุฃุณูุงุก ูุชุดุงุจูุฉ ูู ุณุฌู ูุงุญุฏ.
3. **ุญููุฉ ุงูุชุนูู ุงูููุชูุญุฉ**: ูู `save-and-next.php` (ุงูุฃุณุทุฑ 341-385)ุ ูุชู ุชุณุฌูู ุฃู ุงุฎุชูุงุฑ ูููุณุชุฎุฏู ูู ุฌุฏูู `learning_confirmations` ููุฑุงู. ูุง ููุฌุฏ ุดุฑุท ููุฑุงุฌุนุฉ ุจุดุฑูุฉ ุซุงููุฉ (Double Verification) ูุจู ุงุนุชูุงุฏ ูุฐู ุงูุจูุงูุงุช ููุฑุฌุน ูููุทุงุจูุฉ ุงูุชููุงุฆูุฉ ูุณุชูุจูุงู.

---

## ๐ ุงูุชูุฑุงุฑ ูุงูุชุถุงุฏ ุงูุจูููู

1. **ุชูุฑุงุฑ ููุทู ุงูุฅูุดุงุก**: ุงูููุฏ ุงูุฎุงุต ุจุฅูุดุงุก ุงูููุฑุฏ ููุฑุฑ ูู `api/save-and-next.php` (ุงูุฃุณุทุฑ 80-120) ููู `api/create-supplier.php`.
2. **ุชุถุงุฏ ุงูุชูุตูู**: ูุธุงู ุงููุทุงุจูุฉ ูุชู ูุตูู ุจู "AI Match" ูู ุงูู UIุ ุจูููุง ุงูููุฏ ูู `BankNormalizer` ู `ArabicNormalizer` ูู ุนุจุงุฑุฉ ุนู ุนูููุงุช `String Replacement` ุซุงุจุชุฉ (Hard-coded heuristics) ูููุณุช ููุงุฐุฌ ุชุนูู ุขูู ุงุญุชูุงููุฉ.

---

## ๐ณ๏ธ ุงูููุงููู ุงูุบุงุฆุจุฉ

1. **ุบูุงุจ ุฌุฏุงูู ุงููุนุงููุงุช (Database Transactions)**: ููู `save-and-next.php` ูููุฐ ุนุฏุฉ ุนูููุงุช `INSERT` ู `UPDATE` ูุชุชุงููุฉ (ุงูุฃุณุทุฑ 240-340) ุฏูู ุงุณุชุฎุฏุงู `BEGIN TRANSACTION`. ุฃู ูุดู ูู ููุชุตู ุงูุนูููุฉ ูุชุฑู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุญุงูุฉ ุบูุฑ ูุชุณูุฉ.
2. **ุบูุงุจ ุทุจูุฉ ุงูุชุญูู ุงููุฑูุฒูุฉ (Validation Layer)**: ูุชู ุชูุฑูุฑ ุงูุจูุงูุงุช ูู ุงูู API ุฅูู ุงูู Repositories ููุตูููุงุช ุฎุงู ุฏูู ุงุณุชุฎุฏุงู `Data Transfer Objects (DTOs)` ุฃู ููุงุชุฑ ุชุญูู ุชุถูู ููุทููุฉ ุงูุจูุงูุงุช (ูุซู ุงูุชุฃูุฏ ุฃู `expiry_date` ุชุงุฑูุฎ ุตุงูุญ).

---

## โ๏ธ ููุงุทู ุงููุดู ุงูุตุงูุช

1. **ุชุฌุงูู ุงูุซุบุฑุงุช ูู ุงููุนุงูุฌุฉ ุงูุฐููุฉ**: ูู `api/import.php` (ุงูุณุทุฑ 116)ุ ููุฌุฏ `catch (\Throwable $e)` ูุงุฑุบ. ูุฐุง ูููุน ุงููุณุชุฎุฏู ูู ูุนุฑูุฉ ูุดู ุนูููุฉ ุงููุทุงุจูุฉ ุงูุชููุงุฆูุฉ ุทุงููุง ูุฌุญ ุงูุงุณุชูุฑุงุฏ ุงูุฃููู.
2. **ุชุญููู ุงูุจูุงูุงุช ุบูุฑ ุงูุขูู**: ูู `index.php` (ุงูุณุทุฑ 223)ุ ูุชู ุชุญููู ุงููุจูุบ ุจุงุณุชุฎุฏุงู `floatval` ูุจุงุดุฑุฉ. ุฅุฐุง ุงุญุชูู ุญูู ุงูุฅูุณู ุนูู ูุตูุต ุบูุฑ ุฑูููุฉุ ุณูุชู ุชุญููู ุงููููุฉ ุฅูู `0` ููุชู ุญูุธ ุงููุฑุงุฑ ุนูู ูุฐุง ุงูุฃุณุงุณ ุฏูู ุชูุจูู.

---

## โณ ุงููุฎุงุทุฑ ุงูุชุฑุงูููุฉ ุจูุฑูุฑ ุงูุฒูู

1. **ููู ููุฑุท ูู ุญุฌู ุงูุชุฎุฒูู**: ูููู `TimelineRecorder.php` (ุงูุณุทุฑ 352) ุจุญูุธ ููุฏ HTML ุงููุงูู ููุฎุทุงุจ ูู ุนููุฏ `letter_snapshot` ุนูุฏ ูู ุฅุฌุฑุงุก. ูุน ูุฑูุฑ 5 ุณููุงุชุ ุณูุชุถุฎู ุญุฌู ูุงุนุฏุฉ ุงูุจูุงูุงุช SQLite ุจุดูู ุญุงุฏ ุจุณุจุจ ุชูุฑุงุฑ ุชุฎุฒูู ููุฏ CSS ูุงููุณูู ุงููุชูุฑุฑุฉ ูู ูู ุณุฌู ุชุงุฑูุฎู.
2. **ุชุฏููุฑ ุฏูุฉ ุงููุทุงุจูุฉ (Learning Decay)**: ูุน ุฒูุงุฏุฉ ุนุฏุฏ ุงูุณุฌูุงุช ูู `learning_confirmations` ุฏูู ูุฌูุฏ ุขููุฉ ูุงูุชูุงุก ุตูุงุญูุฉ ุงูุจูุงูุงุช ุงููุฏููุฉ (Time-to-live)ุ ุณุชุทุบู ุงูุณุฌูุงุช ุงููุฏููุฉ ุนูู ุงูุชุบููุฑุงุช ุงูุฌุฏูุฏุฉ ูู ุฃุณูุงุก ุงูููุฑุฏูู ุฃู ุงูุจููู.

---

## ๐ง ุงูุฎูุงุตุฉ: ูุณุชูู ูุถุฌ ุงููุธุงู ููุฏุณููุง

ุงููุธุงู ูุนุชูุฏ ุนูู ุจููุงู **Imperative Scripting** (ุจุฑูุฌุฉ ุฅุฌุฑุงุฆูุฉ ูุชุณูุณูุฉ) ุฃูุซุฑ ูู ุงุนุชูุงุฏู ุนูู ุจููุงู **Object-Oriented Architecture**. ูุฐุง ูุฌุนูู ุณุฑูุน ุงูุฃุฏุงุก ูู ุงูุจุฏุงูุฉุ ููููู ูุด ุฃูุงู ุงูุชุบููุฑุงุช ุงููููููุฉ ูู ุงูุจูุงูุงุช ููุตุนุจ ุตูุงูุชู ุนูู ุงููุฏู ุงูุทููู ุจุณุจุจ ุชุดุชุช ุงูููุทู ุงูุจุฑูุฌู ุจูู ูููุงุช ุงูู API ูุงูู Services.

*ููุงุญุธุฉ: ูุงูุฉ ุงูููุงุญุธุงุช ูุจููุฉ ุนูู ูุญุต ูุจุงุดุฑ ููููุฏ ุงููุตุฏุฑู ูุชุฑููุจุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช (app.sqlite).*
